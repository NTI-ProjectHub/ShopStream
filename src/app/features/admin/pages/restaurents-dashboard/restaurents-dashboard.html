<div class="p-4">
  <h2 class="text-2xl font-bold text-indigo-700 mb-4">Restaurants Dashboard</h2>

  <!-- Error Message -->
  @if (errorMessage) {
    <div class="mb-4 p-4 bg-red-100 text-red-700 rounded-lg">
      {{ errorMessage }}
    </div>
  }

  <!-- Loading State -->
  @if (isLoading) {
    <div class="flex justify-center items-center">
      <svg class="animate-spin h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
      </svg>
    </div>
  } @else {
    <!-- Restaurants Table -->
    <div class="overflow-x-auto">
      <table class="min-w-full bg-white rounded-lg shadow-md">
        <thead class="bg-indigo-600 text-white">
          <tr>
            <th class="py-3 px-4 text-left">Name</th>
            <th class="py-3 px-4 text-left">Username</th>
            <th class="py-3 px-4 text-left">Address</th>
            <th class="py-3 px-4 text-left">Phone</th>
            <th class="py-3 px-4 text-left">Rating</th>
            <th class="py-3 px-4 text-left">Completed Orders</th>
            <th class="py-3 px-4 text-left">Status</th>
            <th class="py-3 px-4 text-left">Created At</th>
            <th class="py-3 px-4 text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (restaurant of restaurants; track restaurant._id) {
            <tr class="border-b">
              <td class="py-3 px-4">{{ restaurant.name }}</td>
              <td class="py-3 px-4">{{ restaurant.username }}</td>
              <td class="py-3 px-4">{{ restaurant.address }}</td>
              <td class="py-3 px-4">{{ restaurant.phone }}</td>
              <td class="py-3 px-4">{{ restaurant.rating }}</td>
              <td class="py-3 px-4">{{ restaurant.completedOrders }}</td>
              <td class="py-3 px-4">
                <span [ngClass]="{
                  'text-green-600': restaurant.status === 'approved',
                  'text-yellow-600': restaurant.status === 'pending',
                  'text-red-600': restaurant.status === 'rejected'
                }">
                  {{ restaurant.status | titlecase }}
                </span>
              </td>
              <td class="py-3 px-4">{{ restaurant.createdAt | date: 'short' }}</td>
              <td class="py-3 px-4">
                <select
                  #statusSelect
                  (change)="updateStatus(restaurant._id, statusSelect.value)"
                  class="border rounded px-2 py-1 focus:ring-2 focus:ring-indigo-400">
                  <option value="approved" [selected]="restaurant.status === 'approved'">Approved</option>
                  <option value="pending" [selected]="restaurant.status === 'pending'">Pending</option>
                  <option value="rejected" [selected]="restaurant.status === 'rejected'">Rejected</option>
                </select>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="9" class="py-3 px-4 text-center text-gray-500">No restaurants found.</td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="mt-4 flex justify-between items-center">
      <div>
        Showing {{ (currentPage - 1) * itemsPerPage + 1 }} to
        {{ currentPage * itemsPerPage > totalRestaurants ? totalRestaurants : currentPage * itemsPerPage }} of
        {{ totalRestaurants }} restaurants
      </div>
      <div class="space-x-2">
        <button
          (click)="changePage(currentPage - 1)"
          [disabled]="currentPage === 1"
          class="px-4 py-2 bg-indigo-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
          Previous
        </button>
        <button
          (click)="changePage(currentPage + 1)"
          [disabled]="currentPage * itemsPerPage >= totalRestaurants"
          class="px-4 py-2 bg-indigo-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
          Next
        </button>
      </div>
    </div>
  }
</div>